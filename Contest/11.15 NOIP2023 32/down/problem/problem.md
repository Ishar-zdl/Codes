<div align='center'>
    <h1> hnfms noip2023_r1</h1>
</div>


| **题目名称**   | **flandre** |  meirin  |  sakuya  | 红楼 ~ Eastern Dream |
| -------------- | :------------: | :----------: | :----------: | :------------------: |
| 题目类型       |     传统型     |    传统型    |    传统型    |        传统型        |
| 目录           |    `flandre`    |    `meirin`    |    `sakuya`    |       `scarlet`       |
| 可执行文件名   |    `flandre`    |    `meirin`    |    `sakuya`    |       `scarlet`       |
| 输入文件名     |   `flandre.in`   |  `meirin.in`  |  `sakuya.in`  |      `scarlet.in`      |
| 输出文件名     |  `flandre.out`  |  `meirin.out`  |  `sakuya.out`  |     `scarlet.out`     |
| 每个测试点时限 |**$1000\text{ms}$**|**$500\text{ms}$**|**$1000\text{ms}$**|**$800\text{ms}$**|
| 内存限制 |**$128.00\text{MB}$**|**$128.00\text{MB}$**|**$256.00\text{MB}$**|**$32.00\text{MB}$**|
| 子任务数目     |  $5$ |  $20$  |  $20$  |                $20$                |
| 结果比较方式   | $\text{Special Judge}$ | 全文比较（忽略行末空格及文末回车） | 全文比较（忽略行末空格及文末回车） | 全文比较（忽略行末空格及文末回车） |

编译选项 `-std=c++14 -O2`

<div style="page-break-after:always;"></div>

<div align='center'>
    <h1> flandre</h1>
</div>
**本题开启Subtask**

## 题目背景

二小姐的烟花 多 好 看 啊！

## 题目描述

芙兰朵露有 $n$ 种烟花，每种都有两个参数：「真实效果」$a$ 和「感觉效果」$b$，其中「真实效果」是一个给定不变的整数（可以为负），「感觉效果」初值等于「真实效果」。

将烟花按一定顺序燃放，先燃放的烟花会使得后面「真实效果」较差的烟花「感觉效果」更差，「真实效果」更优的「感觉效果」更优。

具体来说，**对于所有** $i<j$，即烟花 $i$ 在 $j$ 前燃放，则有以下三种情况：

- $a_i < a_j$ 则 $b_j\gets b_j+k$
- $a_i = a_j$ 则 $b_j$ 不变
- $a_i > a_j$ 则 $b_j\gets b_j-k$

其中 $k$ 为给定常数。

芙兰朵露想使「感觉效果」总和尽量大。也就是说，她想选一部分（可以全选或不选，不能重复选择）按一定顺序燃放，假设选了 $m$ 个，使 $\sum_{i=1}^m b_i$ 最大。输出最大值及方案，有多解输出其一即可。

## 输入格式

第一行两个正整数 $n,k$。

第二行 $n$ 个用空格隔开的整数 $a_{1\cdots n}$ 依次表示 $1$ 号到 $n$ 号烟花的「真实效果」。

## 输出格式

第一行两个整数表示答案 $\max\{\sum\limits_{i=1}^m b_i\}$ 和选择的烟花数量。

第二行依次输出选择烟花的编号，表示按此顺序燃放烟花。

## 样例 #1

### 样例输入 #1

```
3 1
1 2 3
```

### 样例输出 #1

```
9 3
1 2 3
```

## 样例 #2

### 样例输入 #2

```
6 6
1 1 4 5 1 4
```

### 样例输出 #2

```
82 6
2 1 5 6 3 4
```

## 提示

### 样例解释
#### 样例#1
最后的「感觉效果」依次为 $1,3,5$。
#### 样例#2&#3
没有解释。

### 数据范围

| Subtask | 特殊限制 | 分值 |
| :-----: | :-----: | :--: |
| $1$ | $1\le n\le 10$ | $20$ |
| $2$ | $a_i\ge0$ | $10$ |
| $3$ | $1\le n\le 1000$，数据随机 | $20$ |
| $4$ | 数据随机 | $20$ |
| $5$ | 无 | $30$ |

对于 $100\%$ 的数据，满足：
- $1\le n \le 10^6$
- $0\le k \le 10^6$
- $-10^6 \le a_i \le 10^6$

本题第 $4$ 个样例只给出 $\max\{\sum\limits_{i=1}^m b_i\}$ 的值，所以第 $4$ 个样例的输出只有一个数。

------

<div style="page-break-after:always;"></div>

<div align='center'>
    <h1> meirin</h1>



## 题目背景


红美铃又在工作的时候摸鱼了。

她经常在帕秋莉的图书馆借书。作为妖怪，她有着非常强大的学习能力。所以她也学习到了一些 OI 相关的知识！

她偶然看到了 luoguP5686。

题意是给出两个序列 $a,b$ ，求 $\sum\limits_{l=1}^n\sum\limits_{r=l}^n(\sum\limits_{i=l}^ra_i)\times(\sum\limits_{i=l}^rb_i) \bmod1000000007$。

她当然做出来了。

刚好她才学过线段树，会区间加法。

于是她就把区间加法操作搬到了这题上。

但是此时十六夜咲夜发现她了在摸鱼，于是赶紧放下题目留给了你。

## 题目描述

给出两个长度为 $n$ 的序列 $a,b$

$q$ 次操作，每次格式如下

给出 `l r k` 将序列 $b$ 区间 $[l,r]$ 的值每个加上 $k$。

每次操作结束后，查询：

$$\sum\limits_{l=1}^n\sum\limits_{r=l}^n(\sum\limits_{i=l}^ra_i)\times(\sum\limits_{i=l}^rb_i) \bmod1000000007$$

## 输入格式

第一行输入两个整数 $n,q$。

然后一行 $n$ 个整数，表示序列 $a$。

一行 $n$ 个整数，表示序列 $b$。

最后 $q$ 行，每行三个整数 $l,r,k$ 表示一次修改。

## 输出格式

$q$ 行，表示当前序列 $\sum\limits_{l=1}^n\sum\limits_{r=l}^n(\sum\limits_{i=l}^ra_i)\times(\sum\limits_{i=l}^rb_i) \bmod1000000007$ 的值。

## 样例 #1

### 样例输入 #1

```
6 6
1 1 4 5 1 4
1 9 1 9 8 1
1 6 0
1 1 4
1 5 4
4 6 2
1 6 -3
1 6 -20
```

### 样例输出 #1

```
2997
3189
5145
5731
4072
999993019
```

## 提示

| 测试点编号 | 特殊限制 | 分值 |
| :----------: | :----------: | :----------: |
| $1\sim 4$ | $n\le 10^2,q\le10^2$ | $20$ |
| $5\sim 8$ | $n\le 10^5,q\le 5$ | $20$ |
| $9\sim 12$ | $l=r$ | $20$ |
| $13\sim 16$ | $a_i=1$ | $20$ |
| $17\sim 20$ | 无特殊限制 | $20$ |



对于 $100\%$ 的数据，满足：

- $|a_i,b_i,k|\le 10^9$
- $1\le l \le r \le n,1\le n\le 5\times 10^5$
- $q\le 10^6$

<div style="page-break-after:always;"></div>

<div align='center'>
    <h1> sakuya</h1>
</div>

## 题目描述

红魔馆的内部形态是一棵树，总共有 $n$ 个房间，其中它们由 $n-1$ 个走廊连接。

每条走廊都有一个难走程度 $w$ 。

每一天，十六夜咲夜都会打扫房间。

她在打扫房间的时候会使用能力，暂停时间。所以打扫一个房间不要任何时间。然而进过一个走廊是要花费时间的，所话花费的时间就是这个走廊的难走程度。

现在给出 $m$ 个特殊房间，把这些房间记为集合 $A$ 。现在十六夜咲夜想随机的从一个房间开始打扫，然后随机进入另一个 $A$ 中没有被打扫的房间去打扫它，直到把这 $m$ 个房间都打扫干净。

现在，她想知道她把这些房间打扫干净的期望时间对 $998244353$ 取模的值。

换句话说，设 $d(x,y)$ 表示从树上点 $x$ 到 $y$ 的边权和。

将 $A$ 随机打乱得到序列 $a$ 。

求 $\sum\limits_{i=2}^m d(a_{i-1},a_i) \ \ \ \ \ \bmod 998244353$ 。的期望值

但是每天早上，帕秋莉会在某一个房间 $x$ 使用魔法，魔法有一个强度 $k$ 。这会使得所有与 $x$ 相连的走廊的难走程度增加 $k$。（十六夜咲夜：谢谢你啊。）

而你需要回答每天使用魔法后的期望值。

## 输入格式

第一行两个整数 $n,m$。

接下来 $n$ 行，每行三个整数 $u,v,w$，表示 $u$ 到 $v$ 有一条难走程度为 $w$ 的边。

接着一行 $m$ 个整数，表示 $m$ 个特殊房间。

然后输入 $q$，表示询问个数。

$q$ 行，每行两个整数 $x,k$，表示在点 $x$ 使用强度为 $k$ 的魔法。

## 输出格式

$q$ 行，表示每次修改后的期望值。

## 样例 #1

### 样例输入 #1

```
4 3
1 2 1
1 3 2
3 4 3
2 3 4
3
1 0
4 1
1 5
```

### 样例输出 #1

```
8
332748127
665496258
```

## 提示

| 测试点编号 | 特殊限制 | 分值 |
|:---:|:---:|:---:|
| $1\sim 4$ | $1\le n,q\le 10$ | $20$ |
| $5\sim 6$ | $1\le n,q\le 100$ | $10$ |
| $7\sim 10$ | $q=1$ | $20$ |
| $11\sim 12$ | $m=3$ | $10$ |
| $13\sim 14$ | 修改操作只在叶子上 | $10$ |
| $15\sim 20$ | 无 | $30$ |

对于 $100\%$ 的数据：

- $1 \le n\le 5\times 10^5,m\le n,1 \le q \le5\times  10^5$。

- $1 \le w,k \le 10^9$ 。

对于样例中的第一个询问，$a$ 有 `2 3 4`,`2 4 3`,`3 2 4`,`3 4 2`,`4 2 3`,`4 3 2`这 $6$ 种可能，它们的值分别为 $6,9,9,9,9,6$，所以期望为 $\dfrac{6+9+9+9+9+6}{6}=8$

<div style="page-break-after:always;"></div>

<div align='center'>
    <h1> 红楼 ~ Eastern Dream</h1>
</div>

## 题目描述

给出一个长度为 $n$ 的序列 $a$，有 $m$ 次操作，格式如下：

`1 x y k` 对于所有满足 $(i-1) \bmod x \le y$ 的 $i$，将 $a_i$ 的值加 $k$。

`2 l r` 求 $\sum\limits_{i=l}^r a_i$ 。

数组下标从 $1$ 开始。

## 输入格式

第一行两个正整数 $n,m$。

接下来一行 $n$ 个整数表示 $a_i$ 的值。

然后 $m$ 行，每行表示一个操作。

## 输出格式

对于所有的 $2$ 操作，输出答案。

## 样例 #1

### 样例输入 #1

```
6 7
1 1 4 5 1 4
2 1 5
1 1 4 5
2 1 5
1 3 2 1
2 4 6
1 4 2 2
2 1 6
```

### 样例输出 #1

```
12
37
28
62
```

## 提示

| 测试点编号 | 特殊限制 | 分值 |
| :----------: | :----------: | :----------: |
| $1\sim 4$ | $1\le n,m\le 10^3$ | $20$ |
| $5\sim 8$ | $1\le x\le100$ | $20$ |
| $9\sim 12$ | $l=r$ | $20$ |
| $13\sim 16$ | $x\ge \frac{n}{2}$ | $20$ |
| $17\sim 20$ | 无特殊限制 | $20$ |

对于 $100\%$ 的数据，满足：

- $1\le n,m\le 2\times 10^5$
- $1\le x,y \le n$
- $1\le a_i,k\le 10^9$。

**注意本题空间限制**