# NOIP 模拟赛 Round #X

### X 年 X 月 X 日

| 题目名称 | $ \texttt {kotori} $ | $ \texttt {charlotte} $ | $ \texttt {sagiri} $ | $ \texttt {chtholly} $ |
|:---:|:---:|:---:|:---:|:---:|
| 题目类型 | 传统型 | 传统型 | 传统型 | 传统型 |=
| 可执行文件名 | $ \texttt {kotori} $ | $ \texttt {charlotte} $ | $ \texttt {sagiri} $ | $ \texttt {chtholly} $ |
| 输入文件名 | $ \texttt {kotori.in} $ | $ \texttt {charlotte.in} $ | $ \texttt {sagiri.in} $ | $ \texttt {chtholly.in} $ |
| 输出文件名 | $ \texttt {kotori.out} $ | $ \texttt {charlotte.out} $ | $ \texttt {sagiri.out} $ | $ \texttt {chtholly.out} $ |
| 每个测试点时限 | $ 2.0 $ 秒 | $ 2.0 $ 秒 | $ 1.0 $ 秒 | $ 1.0 $ 秒 |
| 内存限制 | $ \texttt {256MB} $ | $ \texttt {256MB} $ | $ \texttt {256MB} $ | $ \texttt {256MB} $ |
| 是否有附加文件 | 是 | 是 | 是 | 是 |

**提交源程序文件名**

| 对于 C++ 语言 | $ \texttt {kotori.cpp} $ | $ \texttt {charlotte.cpp} $ | $ \texttt {sagiri.cpp} $ | $ \texttt {chtholly.cpp} $ |
|:---:|:---:|:---:|:---:|:---:|

**编译选项**

| 对于 C++ 语言 | $ \texttt {-std=c++14 -O2} $ |
|:---:|:---:|

**注意事项（请仔细阅读）**

1. 写文件操作、不建子文件夹。  
2. 文件名（程序名和输入输出文件名）必须使用英文小写。  
3. 选手提交的程序源文件必须不大于 $ \texttt {100KB} $。  
4. 程序可使用的栈空间内存限制与题目的内存限制一致。  
5. 题目很 easy，请选手 AK 后不要大声喧哗。  

## $ \texttt {kotori} $

### 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/kqi5yig1.png)

風になびいたリボンは「风吹过那丝带」

勇気を少しくれるの「给我了些许勇气」

きみがどこまでも優しく「你的温柔无边无际」

明日で待っていて笑うから「明天我也等你的微笑」

### 题目描述

琴里的飞船中有 $ n $ 个人，其中有 $ n - 1 $ 个通道，所以飞船的内部是一个树形结构。每个人从 $ 1\sim n $ 编号，编号越小代表这个人的投票经验最丰富。  

每个人有一个投票装置，初始都没有启动。现在琴里希望她的飞船支持 $ q $ 次操作，每次操作是以下两种行动之一：  

1. 把第 $ x $ 个人的投票装置启动。  

2. 由于每个人都想向经验最丰富的人咨询决策，但又不想绕路地去往一个装置前投票，所以还需要快速查询第 $ x $ 个人到任意一个投票装置的简单路径上的编号最小的人。  

### 输入格式

从文件 $ \texttt {kotori.in} $ 中读入数据。  

第 $ 1 $ 行，两个整数 $ n $ 和 $ q $。  

接下来 $ n - 1 $ 行，每行两个整数 $ a_i $ 和 $ b_i $，分别表示树的每条边。  

接下来 $ q $ 行，每行两个整数 `1 x` 或 `2 x`，分别表示每次操作。  

**本题强制在线**，请令 $ x \leftarrow (x + las) \bmod n + 1 $，其中 $las$ 为上次查询的答案，初始时 $ las = 0 $。  

保证第 $ 1 $ 次操作为操作 $ 1 $。  

### 输出格式

输出到 $ \texttt {kotori.out} $ 中。  

一共若干行，每行仅一个整数，分别表示每次操作 $ 2 $ 的答案。  

### 样例

#### 样例 1

##### 样例 1 输入（$ \texttt {kotori/kotori1.in} $）

```plain
4 6
1 2
2 3
3 4
1 2
1 2
2 2
1 3
2 2
2 2
```

##### 样例 1 输出（$ \texttt {kotori/kotori1.ans} $）

```plain
3
2
1
```

##### 样例 1 解释

解密后的操作为：  

```plain
1 3
1 3
2 3
1 3
2 2
2 1
```

该样例中的树是一条链，唯一启动的投票装置是 $ 3 $ 号点。  

第 $ 1 $ 次询问 `2 3`，路径为 $ 3 $，编号最小的是 $ 3 $。  
第 $ 2 $ 次询问 `2 2`，路径为 $ 2 \to 3 $，编号最小的是 $ 2 $。  
第 $ 3 $ 次询问 `2 1`，路径为 $ 1 \to 2 \to 3 $，编号最小的是 $ 1 $。  

#### 样例 2

见下发文件中的 $ \texttt {kotori/kotori2.in} $ 和 $ \texttt {kotori/kotori2.in} $。  

该样例满足 $ \texttt {Subtask 1} $ 的限制。  

#### 样例 3

见下发文件中的 $ \texttt {kotori/kotori3.in} $ 和 $ \texttt {kotori/kotori3.in} $。  

该样例满足 $ \texttt {Subtask 2} $ 的限制。  

#### 样例 4

见下发文件中的 $ \texttt {kotori/kotori4.in} $ 和 $ \texttt {kotori/kotori4.in} $。  

该样例满足 $ \texttt {Subtask 3} $ 的限制。  

### 数据范围与提示

**【数据范围】**

对于 $ 100\% $ 的数据：满足 $ 1 \leq n, q \leq 10^6 $，$ 1 \leq a_i, b_i \leq n $，$ 1 \leq x \leq n $。  

**【评测方式 & 得分规则】**

对于每个测试点，采用 **全文比较（过滤行末空格及文末回车）** 评测方式。  

**本题采用捆绑测试。** 详情见下表：  

| $ \texttt {Subtask} $ | 测试点编号 | $ n $ | $ q $ | 特殊性质 | 分值 | 子任务依赖 |
|:---:|:---:|:---:|:---:|:---:|:---:|:---:|
| $ 1 $ | $ 1 \sim 15 $ | $ \leq 10^3 $ | $ \leq 10^3 $ | 无 | $ 25 $ | 无 |
| $ 2 $ | $ 16 \sim 30 $ | $ \leq 10^3 $ | $ \leq 10^6 $ | 无 | $ 30 $ | $ 1 $ |
| $ 3 $ | $ 31 \sim 50 $ | $ \leq 10^6 $ | $ \leq 10^6 $ | 无 | $ 45 $ | $ 1, 2 $ |

**【注意事项】**

本题输入量很大，请使用合适的输入输出方式。  

## $ \texttt {charlotte} $

### 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/x25lvtie.png)

风が强く吹いたら「忽然之间一阵风」

もう何も迷わない「我已经不会再迷惘了」

世界の果てさえ「世界的尽头在何处」

仆らは知らない「我们也无处知晓」

### 题目描述

友利奈绪有一棵 $ n $ 个结点的树，编号为 $ 1 \sim n $，并且告诉你哪些结点上有棋子（恰好一颗）。

可以进行若干次操作，每次操作可以将两颗距离至少为 $ 2 $ 的棋子向彼此移动一步。

问能否通过若干次操作使得所有的棋子都在同一个结点上，如果能，请输出最小操作次数；如果不能，请输出 $ -1 $ 。

友利对你使用了「隐身」，因为她看一眼就秒了这个题，她想看看你是否能独立想出这道题。

### 输入格式

从文件 $ \texttt {charlotte.in} $ 中读入数据。  

**每个测试点有多组数据。**  

对于每组数据：  

第 $ 1 $ 行，一个整数 $ n $。  

第 $ 2 $ 行，一个 $ 0/1 $ 字符串，表示树上的每个结点上是否有棋子。  

接下来 $ n - 1 $ 行，每行两个整数 $ a_i, b_i $，分别表示树的每条边。  

### 输出格式

输出到 $ \texttt {charlotte.out} $ 中。

仅一行一个整数表示答案。  

### 样例

#### 样例 1

##### 样例 1 输入（$ \texttt {charlotte/charlotte1.in} $）

```plain
7
0010101
1 2
2 3
1 4
4 5
1 6
6 7
```

##### 样例 1 输出（$ \texttt {charlotte/charlotte1.ans} $）

```plain
3
```

##### 样例 1 解释

可以依次进行以下三个操作集中所有的棋子：  

1. 选择结点 $ 3 $ 和 $ 5 $ 上的棋子。  
2. 选择结点 $ 2 $ 和 $ 7 $ 上的棋子。  
3. 选择结点 $ 4 $ 和 $ 6 $ 上的棋子。  

#### 样例 2

##### 样例 2 输入（$ \texttt {charlotte/charlotte2.in} $）

```plain
7
0010110
1 2
2 3
1 4
4 5
1 6
6 7
```

##### 样例 2 输出（$ \texttt {charlotte/charlotte2.ans} $）

```plain
-1
```

#### 样例 3

见下发文件中的 $ \texttt {charlotte/charlotte3.in} $ 和 $ \texttt {charlotte/charlotte3.ans} $。  

该样例数据满足 $ \sum n \leq 2000 $。  

#### 样例 4

见下发文件中的 $ \texttt {charlotte/charlotte4.in} $ 和 $ \texttt {charlotte/charlotte4.ans} $。  

该样例数据满足 $ \sum n \leq 10^6 $。  

### 数据范围与提示

**【数据范围】**

对于 $ 60\% $ 的数据：满足 $ 1 \leq \sum n \leq 2000 $。  

对于 $ 100\% $ 的数据：满足 $ 1 \leq n \leq 10^6 $，$ 1 \leq a_i, b_i \leq n $，$ 1 \leq \sum n \leq 10^6 $。  

**【评测方式 & 得分规则】**

对于每个测试点，采用 **全文比较（过滤行末空格及文末回车）** 评测方式。  

本题共 $ 25 $ 个测试点，每个测试点 $ 4 $ 分。  

## $ \texttt {sagiri} $

### 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/6ayiga50.png)

「焰火在天空绽放」

「在八月的这一个美好的日子放一支烟花」

「拥挤人潮中牵着的手绝不放开」

「给你的汽水下了咒语将我们想法传达给你」

### 题目描述

纱雾这么聪明当然会数学啦！她出了一道题想要考考你。  

定义 $ f(s) $ 表示 $ s $ 最小表示的开头元素的下标。下标从 $ 1 $ 开始，如果有多个满足的元素则取下标最小的那个。例如，$ f(\texttt {aaaa}) = 1, f(\texttt {babc}) = 2, f(\texttt {qweqweqwe}) = 3 $，因为三个字符串的最小表示分别为 $ \texttt {aaaa}, \texttt {abcb}, \texttt {eqweqweqw} $。  

纱雾有 $ n $ 个字符串 $ s_i $，第 $ i $ 个字符串的长度是 $ a_i $。  

纱雾的字符串是有魔力的，只要使用一个咒语，每个 $ s_i $ 会等概率地随机变成所有长度为 $ a_i $ 且只包含小写字母的 $ 26^{a_i} $ 个字符串的其中一个。  

请你求出 $ \sum_{i = 1}^n [f(s_i) = f(s_{(i \bmod n) + 1})] $ 的期望值，纱雾只需要你回答结果对 $ 998244353 $ 取模后的值。  

### 输入格式

从文件 $ \texttt {sagiri.in} $ 中读入数据。  

第 $ 1 $ 行，一个整数 $ \texttt {sub} $，表示该数据满足的 $ \texttt {Subtask} $ 的编号。  

第 $ 2 $ 行，一个正整数 $ n $。  

第 $ 3 $ 行，$ n $ 个正整数 $ a_i $。  

### 输出格式

输出到 $ \texttt {sagiri.out} $ 中。  

仅一行一个整数表示答案。  

### 样例

#### 样例 1

##### 样例 1 输入（$ \texttt {sagiri/sagiri1.in} $）

```plain
1
2
1 2
```

##### 样例 1 输出（$ \texttt {sagiri/sagiri1.ans} $）

```plain
729486259
```

##### 样例 1 解释

显然 $ f(s_1) = 1 $，$ f(s_2) = 1 + [s_{2, 1} > s_{2, 2}] $，所以 $ P(f(s_1) = f(s_2)) = \dfrac {351} {676}$，所以 $ E(\sum\limits_{i = 1}^n [f(s_i) = f(s_{(i \bmod n) + 1})]) = \dfrac {351} {676} + \dfrac {351} {676} = \dfrac {27} {26} = 729486259 \pmod {998244353} $。  

#### 样例 2

##### 样例 2 输入（$ \texttt {sagiri/sagiri2.in} $）

```plain
5
5
3 1 5 2 4
```

##### 样例 2 输出（$ \texttt {sagiri/sagiri2.ans} $）

```plain
727907401
```

#### 样例 3

见下发文件中的 $ \texttt {sagiri/sagiri3.in} $ 和 $ \texttt {sagiri/sagiri3.ans} $。  

该样例满足 $ \texttt {Subtask 2} $ 的限制。  

#### 样例 4

见下发文件中的 $ \texttt {sagiri/sagiri4.in} $ 和 $ \texttt {sagiri/sagiri4.ans} $。  

该样例满足 $ \texttt {Subtask 3} $ 的限制。  

#### 样例 5

见下发文件中的 $ \texttt {sagiri/sagiri5.in} $ 和 $ \texttt {sagiri/sagiri5.ans} $。  

该样例满足 $ \texttt {Subtask 4} $ 的限制。  

#### 样例 6

见下发文件中的 $ \texttt {sagiri/sagiri6.in} $ 和 $ \texttt {sagiri/sagiri6.ans} $。  

该样例满足 $ \texttt {Subtask 5} $ 的限制。  

### 数据范围与提示

**【数据范围】**

对于 $ 100\% $ 的数据：满足 $ 1 \leq n, a_i \leq 10^5 $。  

**【评测方式 & 得分规则】**

对于每个测试点，采用 **全文比较（过滤行末空格及文末回车）** 评测方式。  

**本题采用捆绑测试。** 详情见下表：  

| $ \texttt {Subtask} $ | 测试点编号 | $ n $ | 特殊性质 | 分值 | 子任务依赖 |
|:---:|:---:|:---:|:---:|:---:|:---:|
| $ 1 $ | $ 1 \sim 5 $ | $ = 2 $ | $ a_i \leq 5 $ | $ 5 $ | 无 |
| $ 2 $ | $ 6 \sim 15 $ | $ \leq 10^5 $ | $ a_i \leq 5 $ | $ 5 $ | $ 1 $ |
| $ 3 $ | $ 16 \sim 25 $ | $ \leq 10^5 $ | $ a_i $ 全为质数 | $ 30 $ | 无 |
| $ 4 $ | $ 26 \sim 35 $ | $ \leq 10^5 $ | $ \sum a_i \leq 10^5 $ | $ 15 $ | 无 |
| $ 5 $ | $ 36 \sim 50 $ | $ \leq 10^5 $ | 无 | $ 45 $ | $ 1, 2, 3, 4 $ |

## $ \texttt {chtholly} $

### 题目背景

![](https://cdn.luogu.com.cn/upload/image_hosting/4hmy0aqp.png)

「在太阳西斜的这个世界，置身天上之森。」

「等这场战争结束后，不归之人与望眼欲穿的众人，人人本着正义之名，长存不灭的过去、逐渐消逝的未来。」

「我回来了，纵使日薄西山，即使看不见未来。」

「此时此刻的光辉，盼君勿忘。」

### 题目描述

珂朵莉在指挥妖精兵少女们改变战斗阵型，所有的妖精兵少女排成了一条链。  

阵型是在一棵 $ n $ 个结点的树上移动，覆盖了从 $ s $ 到 $ t $ 的简单路径。  

妖精兵少女们有两种移动方式：  

1. 最前面的少女向周围没有被覆盖的位置移动一个单位，最后面的少女向前面的方向挪动一个单位；  

2. 最后面的少女向周围没有被覆盖的位置移动一个单位，最前面的少女向后面的方向挪动一个单位。  

问少女们能否将阵形翻转，即最前面的少女移动到 $ t $，最后面的少女移动到 $ s $。  

### 输入格式

从文件 $ \texttt {chtholly.in} $ 中读入数据。  

**每个测试点有多组数据。**  

第 $ 1 $ 行，一个整数 $ T $，表示数据组数。  

对于每组数据：  

第 $ 1 $ 行，三个整数 $ n, s, t $，分别表示结点数量，最前面和最后面的少女的位置。

接下来 $ n - 1 $ 行，每行两个整数 $ a_i, b_i $，分别表示树的每条边。  

### 输出格式

输出到 $ \texttt {chtholly.out} $ 中。

对于每组数据：  

仅一行 `YES` 或 `NO`，表示少女们能否将队形翻转。  

### 样例

#### 样例 1

##### 样例 1 输入（$ \texttt {chtholly/chtholly1.in} $）

```plain
4
8 4 7
1 2
2 3
1 4
4 5
4 6
1 7
7 8
4 3 2
4 3
1 2
2 3
9 3 5
1 2
2 3
3 4
1 5
5 6
6 7
1 8
8 9
16 15 12
1 2
2 3
1 4
4 5
5 6
6 7
4 8
8 9
8 10
10 11
11 12
11 13
13 14
10 15
15 16
```

##### 样例 1 输出（$ \texttt {chtholly/charlotte1.ans} $）

```plain
YES
NO
NO
YES
```

##### 样例 1 解释

对于第 $ 1 $ 组数据：  

![](http://61.186.173.89:2019/2023/07/31/25169b690c732.png)  


对于第 $ 4 $ 组数据：  

某种移动方式为：$ (15, 12) \to (16, 11) \to (15, 13) \to (10, 14) \to (8, 13) \to (4, 11) \to (1, 10) \to (2, 8) \to (3, 4) \to (2, 5) \to (1, 6) \to (4, 7) \to (8, 6) \to (10, 5) \to (11, 4) \to (13, 8) \to (14, 10) \to (13, 15) \to (11, 16) \to (12, 15) $。   

#### 样例 2

见下发文件中的 $ \texttt {chtholly/chtholly2.in} $ 和 $ \texttt {chtholly/chtholly2.ans} $。  

该样例数据满足 $ \sum n \leq 2000 $。  

#### 样例 3

见下发文件中的 $ \texttt {chtholly/chtholly2.in} $ 和 $ \texttt {chtholly/chtholly2.ans} $。  

该样例数据满足 $ \sum n \leq 10^5 $。  

### 数据范围与提示

**【数据范围】**

对于 $ 40\% $ 的数据：满足 $ \sum n \leq 2000 $。  

对于 $ 100\% $ 的数据：满足 $ 1 \leq T \leq 100 $，$ 2 \leq n \leq 10^5 $，$ 1 \leq s, t, a_i, b_i \leq n $，$ s \neq t $，$ \sum n \leq 10^5 $。  

**【评测方式 & 得分规则】**

对于每个测试点，采用 **全文比较（过滤行末空格及文末回车）** 评测方式。  

本题共 $ 25 $ 个测试点，每个测试点 $ 4 $ 分。  
